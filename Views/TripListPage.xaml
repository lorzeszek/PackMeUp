<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="PackMeUp.Views.TripListPage"
             x:Name="TripListView"
             xmlns:viewmodels="clr-namespace:PackMeUp.ViewModels"
             Title="{Binding Title}"
             Shell.NavBarIsVisible="False"
             >

    <!--<Grid Padding="10">
        <Grid.RowDefinitions>
            <RowDefinition Height ="*"/>
            <RowDefinition Height ="Auto"/>
        </Grid.RowDefinitions>

        <CollectionView  Grid.Row="0" ItemsSource="{Binding Trips}" SelectionMode="None">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame HeightRequest="150" Margin="10"
                   Padding="10"
                   HasShadow="True"
                   CornerRadius="5"
                   BackgroundColor="{AppThemeBinding Light={StaticResource Tertiary}, Dark={StaticResource CardBackgroundColorDark}}">
                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding BindingContext.TripTappedCommand, Source={x:Reference TripListView}}"
                  CommandParameter="{Binding .}" />
                        </Frame.GestureRecognizers>

                        <Grid >
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height ="*"/>
                                <RowDefinition Height ="Auto"/>
                            </Grid.RowDefinitions>

                            <StackLayout Grid.ColumnSpan="2" Grid.Row="0" Background="Yellow">
                                <Image Source="italy.jpg" Aspect="AspectFit" />

                            </StackLayout>

                            <VerticalStackLayout Grid.Column="0" Grid.Row="1">
                                <Grid ColumnDefinitions="*,Auto" Padding="0" Margin="0">
                                    <Label Text="{Binding Name}" Grid.Column="0" VerticalOptions="Center" />
                                    <Label Text="{Binding Name}" Grid.Column="1" VerticalOptions="Center" />
                                </Grid>
                            </VerticalStackLayout>

                            --><!-- Ikona kasowania --><!--
                            <ImageButton Grid.Column="1" Grid.Row="1"
                                 Command="{Binding BindingContext.TrashTripCommand, Source={x:Reference TripListView}}"
                                 CommandParameter="{Binding .}"
                                 BackgroundColor="Transparent"
                                 WidthRequest="30"
                                 HeightRequest="30">
                                <ImageButton.Source>
                                    <FontImageSource Glyph="&#xE872;"
                                             FontFamily="MaterialIcons"
                                             Color="OrangeRed"
                                             Size="24"/>
                                </ImageButton.Source>
                            </ImageButton>
                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <Button Grid.Row="1" Margin="0,0,10,0" HorizontalOptions="End"  Text="+" FontSize="Title" Padding="0" MaximumHeightRequest="50" WidthRequest="50" Command="{Binding AddTripCommand}" />

    </Grid>-->

    <Grid Padding="10">

        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- âœ… Lista wycieczek -->
        <CollectionView Grid.Row="0"
                        ItemsSource="{Binding Trips}"
                        SelectionMode="None">

            <CollectionView.ItemsLayout>
                <GridItemsLayout Orientation="Vertical" Span="2" />
            </CollectionView.ItemsLayout>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Border Margin="6"
                            StrokeThickness="0"
                            StrokeShape="RoundRectangle 12"
                            HeightRequest="180"
                            BackgroundColor="Transparent">

                        <Grid>
                            <!-- ðŸ–¼ï¸ TÅ‚o -->
                            <Image Source="italy.jpg"
                                   Aspect="AspectFill"
                                   Opacity="1"/>

                            <!-- ðŸŒ«ï¸ Gradient u doÅ‚u -->
                            <BoxView VerticalOptions="End"
                                     HeightRequest="80"
                                     Opacity="0.6"
                                     BackgroundColor="Black" />

                            <!-- âœï¸ Teksty -->
                            <VerticalStackLayout Padding="12"
                                                 VerticalOptions="End"
                                                 Spacing="2">
                                <!--<Label Text="{Binding Destination}"-->
                                <Label Text="Rzym"
                                       FontSize="18"
                                       FontAttributes="Bold"
                                       TextColor="White"
                                       LineBreakMode="TailTruncation" />

                                <!--<Label Text="{Binding TripDateRange}"-->
                                <Label Text="10 dni"
                                       FontSize="13"
                                       TextColor="White" />

                                <!--<Label Text="{Binding PackingSummary}"-->
                                <Label Text="50%"
                                       FontSize="12"
                                       TextColor="White" />
                            </VerticalStackLayout>

                            <!-- ðŸ—‘ï¸ Ikona usuwania -->
                            <ImageButton Source="delete_icon.png"
                                         BackgroundColor="#66000000"
                                         CornerRadius="12"
                                         HeightRequest="30"
                                         WidthRequest="30"
                                         Padding="4"
                                         HorizontalOptions="End"
                                         VerticalOptions="Start"
                                         Command="{Binding BindingContext.TrashTripCommand, Source={x:Reference TripListView}}"
                                         CommandParameter="{Binding .}" />

                            <!-- ðŸ©¶ Overlay dla zakoÅ„czonych -->
                            <BoxView IsVisible="{Binding IsCompleted}"
                                     BackgroundColor="#80000000" />

                        </Grid>

                        <!-- ðŸ‘† TapniÄ™cie otwiera szczegÃ³Å‚y -->
                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding BindingContext.TripTappedCommand, Source={x:Reference TripListView}}"
                                                  CommandParameter="{Binding .}" />
                        </Border.GestureRecognizers>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <!-- âž• Przycisk dodawania wycieczki -->
        <Button Grid.Row="1"
                Margin="0,10,10,0"
                HorizontalOptions="End"
                Text="+"
                FontSize="Title"
                Padding="0"
                HeightRequest="50"
                WidthRequest="50"
                CornerRadius="25"
                BackgroundColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource PrimaryDark}}"
                TextColor="White"
                Command="{Binding AddTripCommand}" />
    </Grid>
</ContentPage>